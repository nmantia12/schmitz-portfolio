(function($,undefined){"use strict";$us.WProgbar=function(container,options){this.$container=$(container);this.$bar=$('.w-progbar-bar-h',this.$container);this.$count=$('.w-progbar-title-count, .w-progbar-bar-count',this.$container);this.$title=$('.w-progbar-title',this.$container);this.options={delay:100,duration:800,finalValue:100,offset:'10%',startValue:0,value:50};if(this.$container.is('[onclick]')){$.extend(this.options,this.$container[0].onclick()||{});this.$container.removeAttr('onclick')}
$.extend(this.options,options||{});if(/bot|googlebot|crawler|spider|robot|crawling/i.test(navigator.userAgent)){this.$container.removeClass('initial')}
this.$count.text('');$us.waypoints.add(this.$container,this.options.offset,this.init.bind(this))};$.extend($us.WProgbar.prototype,{init:function(){if(this.running){return}
this.running=!0;if(this.$container.hasClass('initial')){this.$container.removeClass('initial')}
var loops=Math.ceil(this.options.duration/this.options.delay),increment=parseFloat(this.options.value)/loops,loopCount=0,handle=null,startValue=0;var funLoop=function(){startValue+=increment;loopCount++;if(handle){$us.clearTimeout(handle)}
if(loopCount>=loops){var result=this.options.template;if(this.options.hasOwnProperty('showFinalValue')){result+=' '+this.options.showFinalValue}
this.$count.text(result);return}
this.render.call(this,startValue);handle=$us.timeout(funLoop.bind(this),this.options.delay)};funLoop.call(this);var finalValue=parseFloat(this.options.finalValue),width=((parseFloat(parseFloat(this.options.value))/parseFloat(finalValue))*100).toFixed(0);this.$bar.on('transitionend webkitTransitionEnd oTransitionEnd MSTransitionEnd',this._events.transitionEnd.bind(this)).css({width:width+'%',transitionDuration:parseInt(this.options.duration)+'ms'})},_events:{transitionEnd:function(){var result=this.options.template;if(this.options.hasOwnProperty('showFinalValue')){result+=' '+this.options.showFinalValue}
this.$count.text(result);this.running=!1}},render:function(value){var index=0,result=(''+this.options.template).replace(/([\-\d\.])/g,function(match){value+='';if(index===0&&match==='0'){if(value.charAt(index+1)==='.'||match==='.'){index++}
return match}
return value.charAt(index++)||''}.bind(this));if(result.charAt(index-1)==='.'){result=result.substr(0,index-1)+result.substr(index)}
if(this.options.hasOwnProperty('showFinalValue')){result+=' '+this.options.showFinalValue}
this.$count.text(result)}});$.fn.wProgbar=function(options){this.each(function(){$(this).data('wProgbar',new $us.WProgbar(this,options))})};$(function(){jQuery('.w-progbar').wProgbar()})})(jQuery)